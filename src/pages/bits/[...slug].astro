---
import Layout from '../../layouts/Layout.astro';
import Tag from '../../components/Tag.astro';
import FormattedDate from '../../components/FormattedDate.astro';
import { getCollection, type CollectionEntry } from 'astro:content';
import getReadingTime from 'reading-time';

export async function getStaticPaths() {
    const posts = await getCollection('bits');
    return posts.map((post: any) => ({
        params: { slug: post.slug },
        props: { post },
    }));
}

type Props = CollectionEntry<'bits'>;
const post = Astro.props.post;
const { Content } = await post.render();
const readingTime = getReadingTime(post.body).minutes.toFixed(0);
---
<Layout title={post.data.title}>
    <div class="mx-auto px-4 py-8 w-full max-w-screen-md">
        <div class="flex flex-col items-center justify-center mb-8">
            <p class="text-6xl font-bold mb-2">{post.data.title}</p>
            <div class="text-sm text-gray-500 mb-2"><FormattedDate date={new Date(post.data.date)} /> | {readingTime} minutes read</div>
            <div class="flex space-x-4 justify-center mb-2">
                {post.data.tags.map((tag: string) => (
                    <Tag tag={tag} href={`/bits/tags/${tag}`} />
                ))}
            </div>
        </div>
        <article class="prose prose-invert prose-lg max-w-none text-justify">
            <Content />
        </article>
    </div>
</Layout>